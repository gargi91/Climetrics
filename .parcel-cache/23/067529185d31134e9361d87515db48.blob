"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.loadWeatherData = exports.getPosition = exports.state = void 0;

var _config = require("./config.js");

var _helper = require("./helper.js");

//State object
const state = {
  location: {
    //setting default location of paris
    lat: 48.8566969,
    lng: 2.3514616
  }
};
exports.state = state;
const options = {
  enableHighAccuracy: true,
  timeout: 5000,
  maximumAge: 0
}; // Getting location using geolocation API

const getPosition = function () {
  return new Promise(function (resolve, reject) {
    navigator.geolocation.getCurrentPosition(position => {
      console.log(position);
    }, err => {
      console.log(state);
    }, options);
  });
};

exports.getPosition = getPosition;

const loadWeatherData = async function () {
  try {
    const lat = state.location.lat;
    const lng = state.location.lng; // Get weather data

    const dataWeather = await (0, _helper.AJAX)(`${_config.WEATHER_API_URL}lat=${lat}&lon=${lng}&appid=${_config.WEATHER_API_KEY}`);
    const tz = data.timezone; // 		state.tz = tz;
    // 		// const times = data.daily.map((el) => {
    // 		// 	return getDateTime(el.dt);
    // 		// });

    saveCurrentWeatherData(data);
    saveDailyWeatherData(data.daily);
    saveHourlyWeatherData(data.hourly);
  } catch (err) {
    throw err;
  }
};

exports.loadWeatherData = loadWeatherData;